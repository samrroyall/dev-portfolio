import { type RunDay, type RunMonth, type StravaData } from "../api/strava";

interface StravaActivity {
  id: number;
  sport_type: string;
  distance: number;
  elapsed_time: number;
  start_date_local: string;
  average_heartrate?: number;
}

const rawMockData: (StravaActivity & any)[] = [
  {
    distance: 13832.1,
    type: "Run",
    sport_type: "Run",
    workout_type: null,
    id: 11111489052,
    start_date: "2024-04-05T11:48:11Z",
    start_date_local: "2024-04-05T06:48:11Z",
    timezone: "(GMT-06:00) America/Chicago",
    utc_offset: -18000.0,
    location_city: null,
    location_state: null,
    location_country: null,
    achievement_count: 0,
    kudos_count: 3,
    comment_count: 0,
    athlete_count: 2,
    photo_count: 0,
    trainer: false,
    commute: false,
    manual: false,
    private: false,
    visibility: "followers_only",
    flagged: false,
    gear_id: "g17042687",
    start_latlng: [41.88817419111729, -87.62021164409816],
    end_latlng: [41.88801568932831, -87.62017115950584],
    average_speed: 3.125,
    max_speed: 5.272,
    has_heartrate: true,
    average_heartrate: 153.2,
    max_heartrate: 170.0,
    heartrate_opt_out: false,
    display_hide_heartrate_option: true,
    elev_high: 182.2,
    elev_low: 177.7,
    upload_id: 11876744599,
    upload_id_str: "11876744599",
    external_id: "2B25F938-407B-406F-B97B-8FC6F3D1662E-activity.fit",
    from_accepted_tag: false,
    pr_count: 0,
    total_photo_count: 0,
    has_kudoed: false,
    suffer_score: 118.0,
  },
  {
    resource_state: 2,
    athlete: {
      id: 66274419,
      resource_state: 1,
    },
    name: "Morning Run",
    distance: 11700.2,
    moving_time: 3872,
    elapsed_time: 3885,
    total_elevation_gain: 6.5,
    type: "Run",
    sport_type: "Run",
    workout_type: null,
    id: 11134071378,
    start_date: "2024-04-08T11:51:02Z",
    start_date_local: "2024-04-08T06:51:02Z",
    timezone: "(GMT-06:00) America/Chicago",
    utc_offset: -18000.0,
    location_city: null,
    location_state: null,
    location_country: null,
    achievement_count: 0,
    kudos_count: 4,
    comment_count: 0,
    athlete_count: 2,
    photo_count: 0,
    trainer: false,
    commute: false,
    manual: false,
    private: false,
    visibility: "followers_only",
    flagged: false,
    gear_id: "g17042687",
    start_latlng: [41.88814099878073, -87.62029688805342],
    end_latlng: [41.88808349892497, -87.62012547813356],
    average_speed: 3.022,
    max_speed: 6.058,
    has_heartrate: true,
    average_heartrate: 149.8,
    max_heartrate: 164.0,
    heartrate_opt_out: false,
    display_hide_heartrate_option: true,
    elev_high: 181.2,
    elev_low: 177.7,
    upload_id: 11900163246,
    upload_id_str: "11900163246",
    external_id: "B637BD14-8D22-485D-A340-14BF9AE4CBBD-activity.fit",
    from_accepted_tag: false,
    pr_count: 0,
    total_photo_count: 0,
    has_kudoed: false,
    suffer_score: 87.0,
  },
  {
    resource_state: 2,
    athlete: {
      id: 66274419,
      resource_state: 1,
    },
    name: "Morning Run",
    distance: 11747.4,
    moving_time: 3666,
    elapsed_time: 3686,
    total_elevation_gain: 18.8,
    type: "Run",
    sport_type: "Run",
    workout_type: null,
    id: 11149158194,
    start_date: "2024-04-10T11:44:41Z",
    start_date_local: "2024-04-10T06:44:41Z",
    timezone: "(GMT-06:00) America/Chicago",
    utc_offset: -18000.0,
    location_city: null,
    location_state: null,
    location_country: null,
    achievement_count: 0,
    kudos_count: 3,
    comment_count: 0,
    athlete_count: 2,
    photo_count: 0,
    trainer: false,
    commute: false,
    manual: false,
    private: false,
    visibility: "followers_only",
    flagged: false,
    gear_id: "g17042687",
    start_latlng: [41.88801736570895, -87.6200838200748],
    end_latlng: [41.888052904978395, -87.62014743871987],
    average_speed: 3.204,
    max_speed: 6.034,
    has_heartrate: true,
    average_heartrate: 152.8,
    max_heartrate: 173.0,
    heartrate_opt_out: false,
    display_hide_heartrate_option: true,
    elev_high: 186.3,
    elev_low: 177.7,
    upload_id: 11915604138,
    upload_id_str: "11915604138",
    external_id: "595F8F2C-D4AD-47F7-8A14-F9928CAC4432-activity.fit",
    from_accepted_tag: false,
    pr_count: 0,
    total_photo_count: 0,
    has_kudoed: false,
    suffer_score: 94.0,
  },
  {
    resource_state: 2,
    athlete: {
      id: 66274419,
      resource_state: 1,
    },
    name: "Morning Run",
    distance: 11800.9,
    moving_time: 3786,
    elapsed_time: 3794,
    total_elevation_gain: 18.9,
    type: "Run",
    sport_type: "Run",
    workout_type: null,
    id: 11187310820,
    start_date: "2024-04-15T11:48:59Z",
    start_date_local: "2024-04-15T06:48:59Z",
    timezone: "(GMT-06:00) America/Chicago",
    utc_offset: -18000.0,
    location_city: null,
    location_state: null,
    location_country: null,
    achievement_count: 0,
    kudos_count: 3,
    comment_count: 0,
    athlete_count: 2,
    photo_count: 0,
    trainer: false,
    commute: false,
    manual: false,
    private: false,
    visibility: "followers_only",
    flagged: false,
    gear_id: "g17042687",
    start_latlng: [41.88810923136771, -87.62019068934023],
    end_latlng: [41.88810529187322, -87.62006705626845],
    average_speed: 3.117,
    max_speed: 5.49,
    has_heartrate: true,
    average_heartrate: 148.4,
    max_heartrate: 164.0,
    heartrate_opt_out: false,
    display_hide_heartrate_option: true,
    elev_high: 186.3,
    elev_low: 177.7,
    upload_id: 11954926577,
    upload_id_str: "11954926577",
    external_id: "2A288926-632A-430B-B1A0-D96450084EE7-activity.fit",
    from_accepted_tag: false,
    pr_count: 0,
    total_photo_count: 0,
    has_kudoed: false,
    suffer_score: 82.0,
  },
  {
    resource_state: 2,
    athlete: {
      id: 66274419,
      resource_state: 1,
    },
    name: "Morning Run",
    distance: 11503.8,
    moving_time: 3737,
    elapsed_time: 3737,
    total_elevation_gain: 6.4,
    type: "Run",
    sport_type: "Run",
    workout_type: null,
    id: 11202213711,
    start_date: "2024-04-17T11:46:42Z",
    start_date_local: "2024-04-17T06:46:42Z",
    timezone: "(GMT-06:00) America/Chicago",
    utc_offset: -18000.0,
    location_city: null,
    location_state: null,
    location_country: null,
    achievement_count: 0,
    kudos_count: 3,
    comment_count: 0,
    athlete_count: 2,
    photo_count: 0,
    trainer: false,
    commute: false,
    manual: false,
    private: false,
    visibility: "followers_only",
    flagged: false,
    gear_id: "g17042687",
    start_latlng: [41.88810017891228, -87.620187420398],
    end_latlng: [41.8880526535213, -87.62012170627713],
    average_speed: 3.078,
    max_speed: 5.86,
    has_heartrate: true,
    average_heartrate: 154.7,
    max_heartrate: 167.0,
    heartrate_opt_out: false,
    display_hide_heartrate_option: true,
    elev_high: 181.2,
    elev_low: 177.7,
    upload_id: 11970165680,
    upload_id_str: "11970165680",
    external_id: "C20DDC5A-58D2-49C0-8699-FA8A78F13111-activity.fit",
    from_accepted_tag: false,
    pr_count: 0,
    total_photo_count: 0,
    has_kudoed: false,
    suffer_score: 105.0,
  },
  {
    resource_state: 2,
    athlete: {
      id: 66274419,
      resource_state: 1,
    },
    name: "Morning Run",
    distance: 8213.0,
    moving_time: 2799,
    elapsed_time: 2899,
    total_elevation_gain: 49.3,
    type: "Run",
    sport_type: "Run",
    workout_type: null,
    id: 11244050659,
    start_date: "2024-04-23T07:07:14Z",
    start_date_local: "2024-04-23T08:07:14Z",
    timezone: "(GMT+00:00) Europe/London",
    utc_offset: 3600.0,
    location_city: null,
    location_state: null,
    location_country: null,
    achievement_count: 0,
    kudos_count: 3,
    comment_count: 0,
    athlete_count: 2,
    photo_count: 0,
    trainer: false,
    commute: false,
    manual: false,
    private: false,
    visibility: "followers_only",
    flagged: false,
    gear_id: "g17042687",
    start_latlng: [51.504613012075424, -0.15343643724918365],
    end_latlng: [51.51344686746597, -0.14162943698465824],
    average_speed: 2.934,
    max_speed: 4.696,
    has_heartrate: true,
    average_heartrate: 150.5,
    max_heartrate: 163.0,
    heartrate_opt_out: false,
    display_hide_heartrate_option: true,
    elev_high: 29.2,
    elev_low: 11.5,
    upload_id: 12013246738,
    upload_id_str: "12013246738",
    external_id: "83C8AB85-5F26-4C55-A682-BF137B618427-activity.fit",
    from_accepted_tag: false,
    pr_count: 0,
    total_photo_count: 0,
    has_kudoed: false,
    suffer_score: 64.0,
  },
];

const metersPerMile = 1609.344;

const mapStrvaActivityToRunDay = ({
  id,
  distance,
  elapsed_time,
  start_date_local,
  average_heartrate,
}: StravaActivity): RunDay => {
  const minutes = elapsed_time / 60;
  const miles = distance / metersPerMile;

  return {
    id,
    dayOfMonth: new Date(start_date_local).getDate(),
    miles,
    minutesPerMile: minutes / miles,
    avgBpm: average_heartrate ? Math.round(average_heartrate) : null,
  };
};

const year = 2024;
const month = 4;
const today = new Date().getDate();

const firstDayOfMonth = new Date(year, month, 1).getDay();
const daysInMonth = new Date(year, month, 0).getDate();

const runs = new Array<RunDay[]>(today).fill(null).map((_) => []);

rawMockData
  .filter(({ sport_type }) => sport_type === "Run")
  .map(mapStrvaActivityToRunDay)
  .forEach((run) => {
    runs[run.dayOfMonth - 1].push(run);
  });

export const getMockStravaData = (): StravaData => ({
  firstDayOfMonth,
  daysInMonth,
  runs,
});
