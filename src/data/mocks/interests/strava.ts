import {
  mapApiStravaActivityToRunDay,
  type ApiStravaActivitiesResponse,
  type RunDay,
  type RunMonth,
  type RunWeek,
} from "../../../models/interests";
import { mockFunc } from "../../../utils";

const rawActivities: ApiStravaActivitiesResponse = [
  {
    resource_state: 2,
    athlete: {
      id: 66274419,
      resource_state: 1,
    },
    name: "Morning Run",
    distance: 13832.1,
    moving_time: 4426,
    elapsed_time: 4550,
    total_elevation_gain: 10.2,
    type: "Run",
    sport_type: "Run",
    workout_type: null,
    id: 11111489052,
    start_date: "2024-04-05T11:48:11Z",
    start_date_local: "2024-04-05T06:48:11Z",
    timezone: "(GMT-06:00) America/Chicago",
    utc_offset: -18000.0,
    location_city: null,
    location_state: null,
    location_country: null,
    achievement_count: 0,
    kudos_count: 3,
    comment_count: 0,
    athlete_count: 2,
    photo_count: 0,
    map: {
      id: "a11111489052",
      summary_polyline:
        "cgt~FhwwuOCIH]Jm@A[Ho@A_@Fq@@g@Im@?cARg@AWI[D_AC_AGi@EKRm@Ci@HSP[j@o@l@SLc@`BBr@IJNH?JIpOBPHl@d@VXr@jAZv@Pv@ZvB@lDNdAJXXl@ZZpAb@h@B|@OpB@ZG~NEh@GTMzEAbEKtG?b@NzHEpAGjADtPK`AVHG\\s@TsAEaDMMQ_@UwAAsBDkAVw@j@w@r@_@`AGh@Rp@j@b@Dh@Ep@D`@KpAEXOt@HLLR@r@`@fBd@t@XnCd@dABzAStAa@zBiA~@q@`C?bAPR]FW\\Lx@OfA[`CKPBDHFr@DPTV`@T~@\\fAPj@@tAI~@[b@Ct@_@l@g@d@i@v@sAL_@t@eA^]b@Wb@Mz@@hBObAU|@c@d@Kl@WdC{Ap@q@fA_Ar@a@jAOn@ApFl@EHSCOB@FLDTGVLxAPFBDb@HBbAAlEmAnAW`@?RF~BfA|BElAJhAAj@MdB{@hACpAUr@c@|Aq@rBs@j@OzAk@xBuALQXI\\YpA]lAo@d@KJQJE|C_A{@h@{@Ri@VWTm@H_Ah@yAd@}BxAo@j@i@L_@VyAZkAj@{Ab@iAv@e@H{BD_@RUTeAb@}ACeBQgBHs@WaAk@u@Mw@FiC`A{A`@c@Di@EOMAQGMcACsA_@POVFAIMC]@aEg@qADiA^q@p@sA`A{E|C{A\\}@PqCJeA^w@r@kAbCiA~AeAj@uCl@qBAaCk@e@a@OUMcAc@I[@KHA`@FTFB?DOYEe@EKI?oARy@\\e@Bc@CO`@KLWIIFOIa@@u@Im@B[JGLe@\\wCpAqA^w@FmAE_Dg@sDiA_@S[W}@FONMEa@@gA`@QM]BIG}@Ig@e@g@Ua@Ei@Fi@Z[Zm@jAI^@vCDj@Pj@b@~@@HBxBGr@CJGBQU}@CUXe@nA]Eu@HeCCkC@aDHmACUDaKDm@Qw@?sCFyH?sDJUL]DoNB_AJ_BAaAJ{@McA_@c@g@O]Uw@EYI{E[oBYcAa@y@m@u@g@a@OIi@Gi@?KDwACiBD}@Iy@DcAGSHaFCOf@]BYPk@`AER@p@E|@BPV`@GH@Bi@TD^Ej@BxCHj@Er@?|@Gh@@h@G~@",
      resource_state: 2,
    },
    trainer: false,
    commute: false,
    manual: false,
    private: false,
    visibility: "followers_only",
    flagged: false,
    gear_id: "g17042687",
    start_latlng: [41.88817419111729, -87.62021164409816],
    end_latlng: [41.88801568932831, -87.62017115950584],
    average_speed: 3.125,
    max_speed: 5.272,
    has_heartrate: false,
    heartrate_opt_out: false,
    display_hide_heartrate_option: true,
    elev_high: 182.2,
    elev_low: 177.7,
    upload_id: 11876744599,
    upload_id_str: "11876744599",
    external_id: "2B25F938-407B-406F-B97B-8FC6F3D1662E-activity.fit",
    from_accepted_tag: false,
    pr_count: 0,
    total_photo_count: 0,
    has_kudoed: false,
    suffer_score: 118.0,
  },
  {
    resource_state: 2,
    athlete: {
      id: 66274419,
      resource_state: 1,
    },
    name: "Morning Run",
    distance: 11700.2,
    moving_time: 3872,
    elapsed_time: 3885,
    total_elevation_gain: 6.5,
    type: "Run",
    sport_type: "Run",
    workout_type: null,
    id: 11134071378,
    start_date: "2024-04-08T11:51:02Z",
    start_date_local: "2024-04-08T06:51:02Z",
    timezone: "(GMT-06:00) America/Chicago",
    utc_offset: -18000.0,
    location_city: null,
    location_state: null,
    location_country: null,
    achievement_count: 0,
    kudos_count: 4,
    comment_count: 0,
    athlete_count: 2,
    photo_count: 0,
    trainer: false,
    commute: false,
    manual: false,
    private: false,
    visibility: "followers_only",
    flagged: false,
    gear_id: "g17042687",
    start_latlng: [41.88814099878073, -87.62029688805342],
    end_latlng: [41.88808349892497, -87.62012547813356],
    average_speed: 3.022,
    max_speed: 6.058,
    has_heartrate: true,
    average_heartrate: 149.8,
    max_heartrate: 164.0,
    heartrate_opt_out: false,
    display_hide_heartrate_option: true,
    elev_high: 181.2,
    elev_low: 177.7,
    upload_id: 11900163246,
    upload_id_str: "11900163246",
    external_id: "B637BD14-8D22-485D-A340-14BF9AE4CBBD-activity.fit",
    from_accepted_tag: false,
    pr_count: 0,
    total_photo_count: 0,
    has_kudoed: false,
    suffer_score: 87.0,
  },
  {
    resource_state: 2,
    athlete: {
      id: 66274419,
      resource_state: 1,
    },
    name: "Morning Run",
    distance: 11747.4,
    moving_time: 3666,
    elapsed_time: 3686,
    total_elevation_gain: 18.8,
    type: "Run",
    sport_type: "Run",
    workout_type: null,
    id: 11149158194,
    start_date: "2024-04-10T11:44:41Z",
    start_date_local: "2024-04-10T06:44:41Z",
    timezone: "(GMT-06:00) America/Chicago",
    utc_offset: -18000.0,
    location_city: null,
    location_state: null,
    location_country: null,
    achievement_count: 0,
    kudos_count: 3,
    comment_count: 0,
    athlete_count: 2,
    photo_count: 0,
    trainer: false,
    commute: false,
    manual: false,
    private: false,
    visibility: "followers_only",
    flagged: false,
    gear_id: "g17042687",
    start_latlng: [41.88801736570895, -87.6200838200748],
    end_latlng: [41.888052904978395, -87.62014743871987],
    average_speed: 3.204,
    max_speed: 6.034,
    has_heartrate: true,
    average_heartrate: 152.8,
    max_heartrate: 173.0,
    heartrate_opt_out: false,
    display_hide_heartrate_option: true,
    elev_high: 186.3,
    elev_low: 177.7,
    upload_id: 11915604138,
    upload_id_str: "11915604138",
    external_id: "595F8F2C-D4AD-47F7-8A14-F9928CAC4432-activity.fit",
    from_accepted_tag: false,
    pr_count: 0,
    total_photo_count: 0,
    has_kudoed: false,
    suffer_score: 94.0,
  },
  {
    resource_state: 2,
    athlete: {
      id: 66274419,
      resource_state: 1,
    },
    name: "Morning Run",
    distance: 11800.9,
    moving_time: 3786,
    elapsed_time: 3794,
    total_elevation_gain: 18.9,
    type: "Run",
    sport_type: "Run",
    workout_type: null,
    id: 11187310820,
    start_date: "2024-04-15T11:48:59Z",
    start_date_local: "2024-04-15T06:48:59Z",
    timezone: "(GMT-06:00) America/Chicago",
    utc_offset: -18000.0,
    location_city: null,
    location_state: null,
    location_country: null,
    achievement_count: 0,
    kudos_count: 3,
    comment_count: 0,
    athlete_count: 2,
    photo_count: 0,
    trainer: false,
    commute: false,
    manual: false,
    private: false,
    visibility: "followers_only",
    flagged: false,
    gear_id: "g17042687",
    start_latlng: [41.88810923136771, -87.62019068934023],
    end_latlng: [41.88810529187322, -87.62006705626845],
    average_speed: 3.117,
    max_speed: 5.49,
    has_heartrate: true,
    average_heartrate: 148.4,
    max_heartrate: 164.0,
    heartrate_opt_out: false,
    display_hide_heartrate_option: true,
    elev_high: 186.3,
    elev_low: 177.7,
    upload_id: 11954926577,
    upload_id_str: "11954926577",
    external_id: "2A288926-632A-430B-B1A0-D96450084EE7-activity.fit",
    from_accepted_tag: false,
    pr_count: 0,
    total_photo_count: 0,
    has_kudoed: false,
    suffer_score: 82.0,
  },
  {
    resource_state: 2,
    athlete: {
      id: 66274419,
      resource_state: 1,
    },
    name: "Morning Run",
    distance: 11503.8,
    moving_time: 3737,
    elapsed_time: 3737,
    total_elevation_gain: 6.4,
    type: "Run",
    sport_type: "Run",
    workout_type: null,
    id: 11202213711,
    start_date: "2024-04-17T11:46:42Z",
    start_date_local: "2024-04-17T06:46:42Z",
    timezone: "(GMT-06:00) America/Chicago",
    utc_offset: -18000.0,
    location_city: null,
    location_state: null,
    location_country: null,
    achievement_count: 0,
    kudos_count: 3,
    comment_count: 0,
    athlete_count: 2,
    photo_count: 0,
    trainer: false,
    commute: false,
    manual: false,
    private: false,
    visibility: "followers_only",
    flagged: false,
    gear_id: "g17042687",
    start_latlng: [41.88810017891228, -87.620187420398],
    end_latlng: [41.8880526535213, -87.62012170627713],
    average_speed: 3.078,
    max_speed: 5.86,
    has_heartrate: true,
    average_heartrate: 154.7,
    max_heartrate: 167.0,
    heartrate_opt_out: false,
    display_hide_heartrate_option: true,
    elev_high: 181.2,
    elev_low: 177.7,
    upload_id: 11970165680,
    upload_id_str: "11970165680",
    external_id: "C20DDC5A-58D2-49C0-8699-FA8A78F13111-activity.fit",
    from_accepted_tag: false,
    pr_count: 0,
    total_photo_count: 0,
    has_kudoed: false,
    suffer_score: 105.0,
  },
  {
    resource_state: 2,
    athlete: {
      id: 66274419,
      resource_state: 1,
    },
    name: "Morning Run",
    distance: 8213.0,
    moving_time: 2799,
    elapsed_time: 2899,
    total_elevation_gain: 49.3,
    type: "Run",
    sport_type: "Run",
    workout_type: null,
    id: 11244050659,
    start_date: "2024-04-23T07:07:14Z",
    start_date_local: "2024-04-23T08:07:14Z",
    timezone: "(GMT+00:00) Europe/London",
    utc_offset: 3600.0,
    location_city: null,
    location_state: null,
    location_country: null,
    achievement_count: 0,
    kudos_count: 3,
    comment_count: 0,
    athlete_count: 2,
    photo_count: 0,
    trainer: false,
    commute: false,
    manual: false,
    private: false,
    visibility: "followers_only",
    flagged: false,
    gear_id: "g17042687",
    start_latlng: [51.504613012075424, -0.15343643724918365],
    end_latlng: [51.51344686746597, -0.14162943698465824],
    average_speed: 2.934,
    max_speed: 4.696,
    has_heartrate: true,
    average_heartrate: 150.5,
    max_heartrate: 163.0,
    heartrate_opt_out: false,
    display_hide_heartrate_option: true,
    elev_high: 29.2,
    elev_low: 11.5,
    upload_id: 12013246738,
    upload_id_str: "12013246738",
    external_id: "83C8AB85-5F26-4C55-A682-BF137B618427-activity.fit",
    from_accepted_tag: false,
    pr_count: 0,
    total_photo_count: 0,
    has_kudoed: false,
    suffer_score: 64.0,
  },
];

const now = new Date();
const daysInMonth = new Date(now.getFullYear(), now.getMonth(), 0).getDate();
const firstDayOfMonth = new Date(now.getFullYear(), now.getMonth(), 1).getDay();
const numWeeks = Math.ceil((firstDayOfMonth + daysInMonth) / 7);

const runs: RunMonth = new Array<RunWeek>(numWeeks).fill(null).map((_, i) =>
  new Array<RunDay[] | null>(7).fill(null).map((_, j) => {
    const adjustedDayIdx = i * 7 + j - firstDayOfMonth;
    return adjustedDayIdx >= 0 && adjustedDayIdx < daysInMonth ? [] : null;
  }),
);

rawActivities
  .filter(({ sport_type }) => sport_type === "Run")
  .map(mapApiStravaActivityToRunDay)
  .forEach((run) => {
    const dayIdx = run.day + firstDayOfMonth;
    runs[Math.floor(dayIdx / 7)][dayIdx % 7].push(run);
  });

export const getMockStravaData = (): Promise<RunMonth> => mockFunc(runs);
